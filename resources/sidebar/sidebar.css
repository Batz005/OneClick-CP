/* =============================
   OneClick-CP Sidebar (Refactor)
   – Single source of truth via CSS variables
   – Light defaults; dark overrides via body.vscode-dark
   – Component rules stay identical across themes
   ============================= */

* { box-sizing: border-box; }

/* ---- Design Tokens (Light defaults) ---- */
:root {
  /* Brand */
  --accent: var(--vscode-button-background, #007acc);
  --accent-hover: var(--vscode-button-hoverBackground, #0a84ff);

  /* Surfaces & Text */
  --surface: var(--vscode-sideBar-background, var(--vscode-editor-background, #ffffff));
  --surface-alt: var(--vscode-editorWidget-background, #f7f7f7);
  --text: var(--vscode-foreground, #1f2328);
  --muted: var(--vscode-descriptionForeground, #6b7280);
  --border: var(--vscode-panel-border, #d0d7de);
  --shadow: 0 2px 10px rgba(0,0,0,0.08);

  /* Compute neutral button tones from accent + surface so they look consistent across themes */
  --btn-bg: color-mix(in srgb, var(--accent) 10%, var(--surface) 90%);
  --btn-hover: color-mix(in srgb, var(--accent) 40%, var(--surface) 60%);
  --btn-border: color-mix(in srgb, var(--accent) 35%, var(--surface) 65%);

  /* States */
  --danger: var(--vscode-inputValidation-errorBorder, #d13438);
  --danger-hover: #f1707a;

  /* Media tweaks */
  --logo-filter: none; /* swapped in dark */

  --footer-height: 56px; /* used for layout spacing */
}

/* ---- Dark overrides: only variables ---- */
body.vscode-dark {
  --surface: var(--vscode-sideBar-background, #1e1e1e);
  --surface-alt: var(--vscode-editorWidget-background, #1b1b1b);
  --text: var(--vscode-foreground, #e7e7e7);
  --muted: var(--vscode-descriptionForeground, #a9b1ba);
  --border: var(--vscode-panel-border, #2a2f36);
  --shadow: 0 2px 14px rgba(0,0,0,0.35);

  /* Dark theme: a bit more accent to maintain contrast */
  --btn-bg: color-mix(in srgb, var(--accent) 22%, var(--surface) 78%);
  --btn-hover: color-mix(in srgb, var(--accent) 50%, var(--surface) 50%);
  --btn-border: color-mix(in srgb, var(--accent) 45%, var(--surface) 55%);

  --logo-filter: invert(1) brightness(1000%);
}
/* =========Font Sizes========*/

/* General scale-down */
body {
  font-size: clamp(11px, 1.2vw, 14px);
}

button {
  padding: 0.25em 0.75em;
  font-size: clamp(10px, 1vw, 13px);
}

input, textarea, select {
  font-size: clamp(10px, 1vw, 13px);
  padding: 0.3em;
}

label {
  font-size: clamp(10px, 1vw, 13px);
}

.accordion {
  font-size: clamp(11px, 1vw, 13px);
  padding: 6px 10px;
}

.panel {
  font-size: clamp(10px, 1vw, 13px);
  padding: 6px 10px;
}
/* ---- Base Layout ---- */
body {
  font-family: var(--vscode-font-family, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji");
  color: var(--text);
  background: transparent;
}

.sidebar-container {
  display: grid;
  grid-template-rows: auto 1fr auto; /* header, scrollable content, footer */
  height: 100vh;
  background: transparent;
  overflow: hidden; /* content scrolls only inside wrapper */
}

.sidebar-wrapper {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  overflow-y: auto;             /* this is the only scroller */
  padding: 0 1rem;              /* horizontal breathing room */
  scroll-padding-bottom: calc(var(--footer-height) + 12px);
}

.sidebar-header {
  flex: 0 0 auto;
  padding: 0.6rem 0 1rem 0;
  text-align: center;
  line-height: 1.2;
  border-bottom: 1px solid var(--border);
}

.logo { max-width: 3rem; max-height: 3rem; display: block; margin: 0.2rem auto 0.6rem; filter: var(--logo-filter); }
.bk-logo { width: 3rem; height: auto; transition: filter .2s; filter: var(--logo-filter); }

.signature {
  grid-row: 3;
  position: sticky;             /* stays visible even if parent ever scrolls */
  bottom: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: .5rem;
  min-height: var(--footer-height);
  padding: .6rem .8rem;
  background: var(--surface);
  border-top: 1px solid var(--border);
  box-shadow: 0 -2px 8px rgba(0,0,0,.06);
  text-align: center;
  font-size: .72rem;
  color: var(--muted);
}

/* ---- Sections ---- */
.section-template, .section-snippets, .section-view { padding: 1rem; border-top: 1px solid var(--border); }
.arrange-btn { width: 100%; margin-top: 1em; }

/* ---- Template Picker ---- */
.template-label { display: block; margin: 1rem 0 .4rem; font-size: 1rem; font-weight: 600; color: var(--muted); }
.template-picker-row { display: flex; align-items: center; gap: .5rem; flex-wrap: wrap; margin-bottom: 1rem; }

#templatePicker {
  flex: 4;
  padding: 0.45rem 0.6rem;
  font-size: 1rem;
  border-radius: 8px;
  border: 1.5px solid var(--btn-border);
  background: var(--surface);
  color: var(--text);
  box-shadow: 0 .5px 2px -1px var(--btn-border);
  transition: border .18s, box-shadow .18s;
}
#templatePicker:focus { outline: 2px solid var(--accent); outline-offset: 1px; }

.delete-btn { background: transparent; border: 0; font-size: 1.2rem; cursor: pointer; color: var(--danger); flex: 1; padding: 0 .3rem; transition: color .2s, transform .15s ease; box-shadow: none; border-left: none; }
.delete-btn:hover { color: var(--danger-hover); transform: translateY(-1px); }
.delete-btn:disabled { color: var(--muted); cursor: not-allowed; }

/* ---- Generic Buttons (incl. accordion & snippet items) ---- */
.button-row { display: flex; gap: .7rem; flex-wrap: wrap; margin-bottom: .6rem; }

.button-row button:not(.delete-btn),
button:not(.delete-btn),
.accordion,
.snippetItem {
  font-size: .97rem;
  font-weight: 600;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  text-align: center;
  background: var(--btn-bg);
  color: var(--text);
  border-radius: 8px;
  border: 1.5px solid var(--btn-border);
  border-left: 4px solid var(--accent);
  padding: .48rem 1.1rem .48rem .9rem;
  margin-bottom: .15rem;
  box-shadow: var(--shadow);
  transition: background-color .2s, border .2s, box-shadow .2s, color .2s, transform .15s ease;
}

.button-row button:hover,
button:hover,
.accordion:hover,
.snippetItem:hover {
  background: var(--btn-hover);
  color: var(--text);
  border-color: var(--btn-border);
  border-left-color: var(--accent);
  transform: translateY(-1px);
}

.button-row button:active,
button:active,
.accordion:active,
.snippetItem:active { transform: translateY(0); box-shadow: inset 0 1px 3px rgba(0,0,0,.18); }

.button-row button:focus-visible,
button:focus-visible,
.accordion:focus-visible,
.snippetItem:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }

.button-row button:disabled,
button:disabled,
.accordion:disabled,
.snippetItem:disabled { opacity: .55; cursor: not-allowed; color: var(--muted); }

/* ---- Accordion Panels ---- */
.accordion { text-align: left; box-shadow: 0 1px 4px rgba(0,0,0,.08); }
.accordion.active { background: var(--btn-hover); }

.panel {
  display: none;
  flex-direction: column;
  padding: .6em .6em .8em;
  background: transparent;
  max-height: clamp(240px, 45vh, 520px); /* larger but bounded */
  overflow-y: auto;                       /* scroll inside panel */
  border-left: 3px solid transparent;
  gap: .6em;
}
.panel > button { margin-top: .2em; min-height: 36px; }

/* ---- Snippet Items ---- */
.snippetItem { cursor: pointer; }

/* ---- Options / Language ---- */
.snippet-options { display: flex; flex-direction: column; align-items: flex-start; gap: .35em; margin-bottom: 1.2em; }
.snippet-options label { display: flex; align-items: center; gap: .45em; font-weight: 600; font-size: 1rem; }
.snippet-options small { color: var(--muted); }

/* Language select wrapper for label + dropdown */
.language-select-wrapper { display: flex; flex-direction: column; margin-top: .45em; gap: .25em; width: 100%; }

#languagePicker {
  width: 100%;
  max-width: 190px;
  padding: .35em .8em;
  border-radius: 8px;
  border: 1.5px solid var(--btn-border);
  font-size: 1rem;
  background: var(--surface);
  color: var(--text);
  transition: border .18s, box-shadow .18s;
  box-shadow: 0 .5px 2px -1px var(--btn-border);
}
#languagePicker:focus { outline: 2px solid var(--accent); outline-offset: 1px; }

/* ---- Tooltip ---- */
.snippet-tooltip {
  position: fixed;
  background: var(--vscode-editorHoverWidget-background, var(--surface-alt));
  color: var(--vscode-editorHoverWidget-foreground, var(--text));
  border: 1px solid var(--vscode-editorHoverWidget-border, var(--border));
  padding: .55em .7em;
  z-index: 1500;
  font-family: var(--vscode-editor-font-family, ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace);
  font-size: .85em;
  line-height: 1.35;
  white-space: pre-wrap;
  word-break: break-word;
  tab-size: 2;
  box-shadow: var(--shadow);
  max-width: 520px;
  max-height: 320px;
  overflow: auto;
  display: none;
  border-radius: 6px;
  pointer-events: none; /* no flicker when hovering near tooltip */
}

/* ---- Scrollbar (panels only) ---- */
.panel::-webkit-scrollbar { width: 8px; }
.panel::-webkit-scrollbar-thumb { background: var(--vscode-scrollbarSlider-background, #bbb); border-radius: 4px; }

/* ---- Misc text ---- */
.coming-soon { margin-top: 2rem; font-style: italic; color: var(--muted); font-size: .95rem; text-align: center; }

/* ---- Create Snippet Button ---- */
.create-snippet-btn { width: fit-content; }

/* ---- Dialog Styling ---- */
dialog { border: 1px solid var(--border); border-radius: 10px; background: var(--surface); color: var(--text); padding: 1rem 1.1rem; box-shadow: var(--shadow); }
dialog::backdrop { background: rgba(0,0,0,.35); }

.dialog-form h4 { margin: 0 0 .5rem; }
.dialog-form .dialog-info { color: var(--muted); margin: 0 0 .6rem; }

.dialog-form label { display: block; font-weight: 600; margin: .5rem 0 .25rem; }
.dialog-form input, .dialog-form select, .dialog-form textarea {
  width: 100%; border: 1.5px solid var(--btn-border); border-radius: 8px; padding: .45rem .6rem; background: var(--surface); color: var(--text);
}
.grid-two { display: grid; grid-template-columns: 1fr 1fr; gap: .6rem; }
.dialog-actions { display: flex; align-items: center; gap: .6rem; margin-top: .7rem; }
.dialog-actions .spacer { flex: 1; }